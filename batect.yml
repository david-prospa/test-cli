containers:
  cli:
    image: mcr.microsoft.com/azure-cli:2.9.1
    working_directory: /app
    volumes:
      - local: .
        container: /app
      - local: ${AZURE_CONFIG_DIR}
        container: /root/.azure

  local-cli:
    image: mcr.microsoft.com/azure-cli:2.9.1
    working_directory: /app
    volumes:
      - local: .
        container: /app

tasks:
  run-cli:
    run:
      container: cli
      command: az account list -o table

  run-local:
    run:
      container: local-cli
      command: sh -c 'az login && az account list -o table'
      environment:
        AZURE_CONFIG_DIR: /tmp/.azure
